:root {
  --bg-dark: #0a0e14;
  --bg-card: #1a1f2e;
  --bg-card-hover: #252b3d;
  --bg-field: #12161f;
  --bg-overlay: rgba(5, 8, 12, 0.7);

  --gold: #d4a853;
  --gold-light: #f0d078;
  --gold-dark: #a67c32;

  --hp-red: #e74c3c;
  --atk-yellow: #f1c40f;
  --mana-blue: #3498db;

  --predator: #c0392b;
  --prey: #27ae60;
  --spell: #2980b9;
  --freespell: #8e44ad;
  --trap: #d35400;

  --text-primary: #f5f5f5;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;

  --border-subtle: rgba(255, 255, 255, 0.08);
  --border-gold: rgba(212, 168, 83, 0.5);

  --font-display: "Bebas Neue", sans-serif;
  --font-body: "Barlow", sans-serif;

  --card-radius: 8px;
  --transition-fast: 0.15s ease;
  --transition-medium: 0.25s ease;
  --action-bar-safe: clamp(170px, 18vh, 240px);
  --field-max-height: min(66vh, 700px);
  --field-gap: clamp(8px, 1.5vw, 16px);
  --hand-overlap: clamp(24px, 3vw, 48px);

  /* Minimum heights for zoom stability */
  --min-container-height: 600px;
  --min-pages-height: 500px;
  --min-battlefield-height: 480px;
  --min-hand-height: clamp(100px, 15vh, 140px);
  --min-inspector-height: 200px;
  --min-log-height: 150px;
  --min-piles-height: 80px;

  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}

/* Adjust minimums for extreme zoom scenarios */
@media (max-height: 500px) {
  :root {
    --min-container-height: 500px;
    --min-battlefield-height: 380px;
    --min-hand-height: 80px;
    --min-inspector-height: 120px;
    --min-log-height: 120px;
    --min-piles-height: 60px;
  }
}

.hidden {
  display: none;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html,
body {
  height: 100%;
  overflow: hidden;
  background: var(--bg-dark);
  color: var(--text-primary);
  font-family: var(--font-body);
  width: 100vw;
  max-width: 100vw;
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image: radial-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 0);
  background-size: 4px 4px;
  opacity: 0.18;
  z-index: 0;
}

button {
  font-family: inherit;
  cursor: pointer;
  border: none;
  background: none;
  color: inherit;
}

.muted {
  color: var(--text-muted);
}

.game-container {
  position: fixed;
  inset: 0;
  z-index: 1;
  height: 100vh;
  max-height: 100vh;
  min-height: var(--min-container-height); /* Prevent total collapse on extreme zoom */
  display: flex;
  flex-direction: column;
  padding-top: calc(12px + var(--safe-top));
  padding-bottom: calc(12px + var(--safe-bottom));
  width: 100vw;
  max-width: 100vw;
  min-width: 320px;
  overflow: hidden;
}

.top-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 18px;
  border-bottom: 1px solid var(--border-gold);
  gap: 12px;
}

.player-badge {
  display: flex;
  align-items: center;
  gap: 12px;
  background: rgba(255, 255, 255, 0.02);
  padding: 8px 12px;
  border-radius: 999px;
  position: relative;
}

.player-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.player-info.right {
  text-align: right;
}

.player-name {
  font-family: var(--font-display);
  letter-spacing: 0.04em;
  font-size: 18px;
}

.ai-speed-toggle {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 4px;
  padding: 2px 6px;
  margin-left: 8px;
  font-size: 16px;
  cursor: pointer;
  transition: background 0.2s, transform 0.15s;
  vertical-align: middle;
}

.ai-speed-toggle:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.1);
}

.ai-speed-toggle:active {
  transform: scale(0.95);
}

.player-stats {
  display: flex;
  gap: 8px;
  font-size: 14px;
  color: var(--text-secondary);
}

.player-badge.is-active {
  box-shadow: 0 0 0 rgba(240, 208, 120, 0.35);
  animation: active-breathe 2.6s ease-in-out infinite;
}

.player-badge.is-active .player-name {
  text-shadow: 0 0 10px rgba(240, 208, 120, 0.65);
}

.turn-badge {
  padding: 6px 16px;
  border-radius: 999px;
  border: 1px solid var(--border-gold);
  background: rgba(212, 168, 83, 0.1);
  text-align: center;
  min-width: 110px;
  animation: glow 2.5s ease-in-out infinite;
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}

.turn-number {
  display: block;
  font-family: var(--font-display);
  font-size: 16px;
  letter-spacing: 0.08em;
}

.phase-label {
  font-size: 14px;
  color: var(--text-secondary);
}

.turn-badge:hover:not(:disabled) {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(212, 168, 83, 0.25);
}

.turn-badge:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  box-shadow: none;
}

.turn-badge:focus-visible {
  outline: 2px solid var(--gold-light);
  outline-offset: 2px;
}

.pages-container {
  flex: 1;
  position: relative;
  overflow: visible; /* Allow cards to overflow */
  padding: clamp(12px, 2vw, 20px) clamp(8px, 1vw, 14px) 0;
  width: 100%;
  max-width: 100%;
  min-height: var(--min-pages-height); /* Ensure content area doesn't collapse */
}

.page {
  position: absolute;
  inset: 0;
  opacity: 0;
  transform: translateX(20px);
  transition: opacity var(--transition-medium), transform var(--transition-medium);
  pointer-events: none;
  overflow: visible; /* Allow hand cards to overflow upward */
}

.page.active {
  opacity: 1;
  transform: translateX(0);
  pointer-events: auto;
}

.page.exit-left {
  opacity: 0;
  transform: translateX(-20px);
}

.battlefield-layout-three-column {
  display: grid;
  grid-template-columns: minmax(0, 1fr) minmax(0, 2fr) minmax(0, 1fr);
  gap: clamp(10px, 1.5vw, 18px);
  height: 100%;
  max-height: 100%;
  min-height: var(--min-battlefield-height); /* Prevent collapse at high zoom */
  width: 100%;
  max-width: 100%;
  overflow: visible; /* Allow hand cards to overflow upward */
}

.battlefield-left-column,
.battlefield-right-column {
  display: flex;
  flex-direction: column;
  gap: clamp(8px, 1.2vw, 16px);
  min-width: 0;
  max-width: 100%;
  min-height: 0;
  overflow-y: auto; /* Enable scrolling if content is too tall for viewport */
  overflow-x: hidden;
}

.battlefield-center-column {
  display: flex;
  flex-direction: column;
  gap: clamp(8px, 1.2vw, 16px); /* Add gap between battlefield and hand */
  min-width: 0;
  width: 100%;
  max-width: 100%;
  height: 100%;
  min-height: 0;
  position: relative;
  overflow-x: hidden;
  overflow-y: visible; /* Allow cards to overflow upward */
}

.battlefield-layout {
  display: grid;
  grid-template-rows: minmax(0, 2.33fr) minmax(0, 1fr); /* 70% field / 30% hand ratio */
  gap: clamp(6px, 1vw, 12px); /* Tighter gap for better packing */
  flex: 1; /* Take available space and shrink as needed */
  min-height: 0; /* Allow to shrink completely if needed */
  min-width: 0;
  width: 100%;
  overflow: visible; /* No scrolling, let it pack tightly */
}

.battlefield-region {
  min-height: 0;
  min-width: 0;
  position: relative;
  overflow: visible; /* Allow cards to overflow */
  display: flex;
  flex-direction: column;
  flex: 1;
}

.battle-effects {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 4;
}

.battlefield {
  display: flex;
  flex-direction: column;
  gap: var(--field-gap);
  flex: 1;
  min-height: 0;
  height: 100%;
  max-height: 100%;
  justify-content: space-between;
  width: 100%;
  max-width: 100%;
}

.field-row {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: var(--field-gap);
  width: 100%;
  min-height: 0; /* Allow flexbox to manage height */
  flex: 1; /* Take equal space in parent grid */
}

.field-slot {
  background: var(--bg-field);
  border: 1px dashed var(--border-subtle);
  border-radius: var(--card-radius);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  font-size: clamp(10px, 1.2vw, 14px);
  width: 100%;
  height: 100%;
  min-height: 0;
  padding: 4px;
  box-sizing: border-box;
}

/* Cards in field slots maintain standard playing card dimensions */
.field-slot .card {
  width: auto;
  height: 100%;
  max-height: 100%;
  aspect-ratio: 5 / 7; /* Standard playing card ratio */
  margin: 0;
  box-sizing: border-box;
}

.field-slot .card .card-inner {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.field-slot .card .card-name {
  font-size: clamp(10px, 1.1vw, 13px);
}

.field-slot .card .card-image-container {
  /* Inherit proportions from base card styles */
}

.field-slot .card .card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.field-slot .card .card-stats-row {
  padding: 0 2px;
}

.field-slot .card .card-stat {
  font-size: clamp(10px, 1vw, 12px);
  padding: 0 2px;
}

.field-slot .card .card-keywords {
  font-size: clamp(9px, 0.9vw, 11px);
}

.field-slot .card .card-effect {
  font-size: clamp(9px, 0.9vw, 11px);
}

.field-divider {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2px 0;
  min-width: 0;
}

.divider-line {
  flex: 1;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  opacity: 0.6;
}

.divider-orb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: radial-gradient(circle, var(--gold-light), var(--gold-dark));
  box-shadow: 0 0 12px rgba(212, 168, 83, 0.6);
}

.field-divider-text {
  font-size: clamp(10px, 1.2vw, 13px);
  letter-spacing: 0.01em;
  color: var(--text-secondary);
  text-align: center;
  white-space: nowrap;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  width: 100%;
}

.mobile-nav-left,
.mobile-nav-right {
  display: none;
  position: absolute;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid var(--border-gold);
  border-radius: 50%;
  width: 40px;
  height: 40px;
  align-items: center;
  justify-content: center;
  color: var(--gold-light);
  cursor: pointer;
  transition: all var(--transition-fast);
  z-index: 10;
}

.mobile-nav-left {
  left: 8px;
}

.mobile-nav-right {
  right: 8px;
}

.mobile-nav-left:hover,
.mobile-nav-right:hover {
  background: rgba(212, 168, 83, 0.3);
  transform: scale(1.1);
}

.mobile-nav-left:active,
.mobile-nav-right:active {
  transform: scale(0.95);
}

.info-toggle {
  position: absolute;
  right: 0;
  font-size: 10px;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  padding: 4px 8px;
  border-radius: 999px;
  border: 1px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.05);
  color: var(--text-secondary);
  transition: color var(--transition-fast), border-color var(--transition-fast);
}

.info-toggle:hover {
  color: var(--gold-light);
  border-color: var(--border-gold);
}

.info-toggle--back {
  position: static;
  padding: 4px 10px;
  font-size: 11px;
}

.hand-panel {
  display: flex;
  align-items: stretch;
  padding: clamp(4px, 0.8vw, 8px) clamp(8px, 1.2vw, 16px) clamp(8px, 1.2vw, 16px);
  background: linear-gradient(180deg, rgba(10, 14, 20, 0.4), rgba(10, 14, 20, 0.92));
  border-top: 1px solid var(--border-subtle);
  box-shadow: 0 -12px 24px rgba(0, 0, 0, 0.35);
  border-radius: clamp(12px, 2vw, 20px) clamp(12px, 2vw, 20px) 0 0;
  overflow-x: hidden; /* Prevent horizontal growth beyond center column */
  overflow-y: visible !important; /* Allow upward hover/expansion */
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  min-height: var(--min-hand-height); /* Scale with viewport but enforce minimums */
  max-height: 40vh; /* Prevent hand from taking too much space */
  min-width: 0;
  flex-shrink: 0; /* Prevent hand from being crushed by flex layout */
}

.hand-container {
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1vw, 12px);
  height: 100%;
  width: 100%;
  min-height: 0;
  min-width: 0;
  max-width: 100%;
  overflow: visible !important; /* Force visible to prevent card cutoff */
}

.hand-header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 12px;
}

/* Hand expansion toggle removed - using compact hand by default */

.hand-title {
  font-family: var(--font-display);
  font-size: 20px;
  letter-spacing: 0.05em;
}

.hand-hint {
  font-size: 13px;
  color: var(--text-muted);
}

.hand-grid {
  display: flex;
  align-items: flex-end;
  justify-content: center; /* Center the card fan like Hearthstone/Balatro */
  flex-wrap: nowrap;
  gap: 0;
  overflow-x: visible; /* Let cards overflow rather than scroll */
  overflow-y: visible;
  padding: 0 clamp(4px, 0.8vw, 8px) clamp(8px, 1.2vw, 16px);
  min-height: 0;
  width: 100%;
  flex: 1;
  min-width: 0;
  max-width: min(100%, 600px); /* Constrain width to force card overlap */
  margin: 0 auto; /* Center the constrained hand-grid */
  box-sizing: border-box;
  position: relative;
  z-index: 1; /* Create stacking context for cards */
}

.hand-grid .card {
  flex: 0 0 auto; /* Don't shrink - use overlap instead */
  width: clamp(100px, min(16vw, 130px), 150px);
  min-width: 90px; /* Minimum width to remain readable */
  aspect-ratio: 5 / 7; /* Standard playing card ratio */
  margin-left: calc(var(--hand-overlap) * -1);
  transform-origin: bottom center;
  transform: translateY(8px) scale(0.98);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast), z-index 0.2s;
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.35);
  position: relative;
  font-size: 20px;
  z-index: 10; /* Base z-index for hand cards */
}

/* Dynamic hand expansion mode */
.battlefield-center-column.hand-expanded .battlefield-layout {
  grid-template-rows: minmax(140px, 1.5fr) minmax(140px, 1fr); /* Expanded hand takes more space */
  flex: 0 1 auto; /* Allow more shrinking to make room for hand */
}

.battlefield-center-column.hand-expanded .hand-panel {
  overflow: visible;
  min-height: clamp(180px, 28vh, 260px); /* Taller expanded height */
  max-height: 55vh; /* Allow more space when expanded */
}

.battlefield-center-column.hand-expanded .hand-grid {
  align-items: center;
  min-height: 180px;
}

.battlefield-center-column.hand-expanded .hand-grid .card {
  width: clamp(110px, min(18vw, 150px), 170px);
}

.battlefield-center-column.hand-expanded .hand-grid .card.hand-focus {
  transform: translateY(-40px) scale(1.4);
  z-index: 3000; /* Highest z-index for expanded focused cards */
}

.hand-grid .card:first-child {
  margin-left: 0;
}

.hand-grid .card.hand-focus {
  z-index: 2000; /* Highest z-index for focused cards */
  transform: translateY(-25px) scale(1.15);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
}

/* Hover handled by JavaScript proximity detection - see hand-focus class */
/* .hand-grid .card:hover {
  z-index: 1000;
  transform: translateY(-15px) scale(1.05);
} */

.hand-grid .card .card-name {
  font-size: 13px;
}

.hand-grid .card .card-header {
  padding: 6px 8px;
}

.hand-grid .card .card-footer {
  padding: 6px 8px;
  gap: 4px;
}

.hand-grid .card .card-stat-box {
  padding: 3px 6px;
  gap: 3px;
}

.hand-grid .card .card-stat-box .stat-emoji {
  font-size: 13px;
}

.hand-grid .card .card-stat-box .stat-value {
  font-size: 13px;
}

.hand-grid .card .card-text-area {
  font-size: 10px;
}

.hand-grid .card .card-actions {
  gap: 4px;
}

.hand-grid .card .card-actions button {
  font-size: 12px;
  padding: 4px 6px;
}

.game-log-panel {
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: clamp(8px, 1.2vw, 12px);
  padding: clamp(8px, 1.2vw, 14px);
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow-x: hidden;
  overflow-y: auto; /* Allow scrolling if log content is too tall */
  min-height: var(--min-log-height); /* Ensure minimum visibility */
  max-height: 100%; /* Don't exceed parent */
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

.card-inspector-panel {
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: clamp(8px, 1.2vw, 12px);
  padding: clamp(8px, 1.2vw, 14px);
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1vw, 10px);
  flex: 1; /* Allow to grow but can shrink */
  min-height: var(--min-inspector-height); /* Ensure minimum visibility */
  max-height: 100%; /* Don't exceed parent */
  overflow-x: hidden;
  overflow-y: auto; /* Allow scrolling if content is too tall */
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

.inspector-header,
.log-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.inspector-header h3,
.log-header h3 {
  font-family: var(--font-display);
  letter-spacing: 0.04em;
  color: var(--gold-light);
  font-size: 30px;
  margin: 0;
}

.inspector-content {
  flex: 1;
  overflow-y: auto; /* Allow scrolling if content is too tall */
  padding-right: 6px;
  font-size: 26px;
  color: var(--text-secondary);
}

.inspector-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--text-muted);
  font-style: italic;
  font-size: 13px;
}

.inspector-card-layout {
  display: flex;
  flex-direction: column;
  gap: 16px;
  height: 100%;
  min-height: 0;
}

.inspector-card-image {
  flex: 0 0 auto;
  width: 100%;
  margin: 0;
}

.inspector-image-container {
  width: 100%;
  aspect-ratio: 4 / 3;
  background: rgba(255, 255, 255, 0.03);
  border: 2px dashed var(--border-subtle);
  border-radius: var(--card-radius);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.inspector-card-image-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: calc(var(--card-radius) - 2px);
}

.inspector-image-placeholder {
  font-size: 48px;
  opacity: 0.7;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  justify-content: center;
}

.inspector-card-content {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 8px;
  overflow-y: auto;
  padding-right: 6px;
}

.inspector-card-content h4 {
  margin: 0;
  font-family: var(--font-display);
  font-size: 20px;
  color: var(--text-primary);
  letter-spacing: 0.04em;
}

.inspector-card-content .meta {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.5;
}

.inspector-card-content .effect {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.5;
  margin-top: 4px;
}

.inspector-card-content .keyword-glossary {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--border-subtle);
}

.inspector-card-content .keyword-glossary strong {
  font-size: 15px;
  color: var(--text-primary);
  display: block;
  margin-bottom: 6px;
}

.inspector-card-content .keyword-glossary ul {
  margin: 0;
  padding-left: 16px;
  list-style: none;
}

.inspector-card-content .keyword-glossary li {
  font-size: 13px;
  color: var(--text-secondary);
  margin-bottom: 4px;
  line-height: 1.4;
}

.inspector-card-content .keyword-glossary li strong {
  color: var(--text-primary);
}

/* Deck construction mode - full width for content */
.inspector-deck-mode {
  width: 100%;
  height: 100%;
  overflow-y: auto;
  padding-right: 6px;
}

.inspector-deck-mode h4 {
  margin-top: 0;
  font-size: 20px;
}

.inspector-deck-mode .meta {
  font-size: 14px;
  line-height: 1.5;
  margin-bottom: 8px;
}

.inspector-deck-mode .effect {
  font-size: 14px;
  line-height: 1.5;
  margin: 12px 0;
}

.inspector-deck-mode .keyword-glossary {
  margin-top: 16px;
  padding-top: 12px;
  border-top: 1px solid var(--border-subtle);
}

.inspector-deck-mode .keyword-glossary strong {
  font-size: 15px;
  margin-bottom: 8px;
}

.inspector-deck-mode .keyword-glossary li {
  font-size: 13px;
  line-height: 1.4;
  margin-bottom: 6px;
}

/* Responsive inspector for mobile */
@media (max-width: 768px) {
  .inspector-card-layout {
    flex-direction: column;
    gap: 12px;
  }
  
  .inspector-card-image {
    width: 100%;
    max-width: 180px;
    margin: 0 auto;
  }
  
  .inspector-image-container {
    max-height: 200px;
  }
}

.log-content {
  flex: 1;
  overflow-y: auto;
  padding-right: 6px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-height: 0;
  margin-top: 10px;
  font-size: 26px;
  color: var(--text-secondary);
}

.log-entry {
  font-size: 22px;
  color: var(--text-secondary);
  padding: 4px 6px;
  background: rgba(255, 255, 255, 0.02);
  border-radius: 6px;
  border-left: 2px solid var(--border-gold);
}

.log-turn {
  font-weight: 600;
  color: var(--gold-light);
}

.log-action {
  margin-left: 8px;
}

.piles-section {
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: clamp(8px, 1.2vw, 12px);
  padding: clamp(8px, 1.2vw, 14px);
  margin-top: clamp(8px, 1.2vw, 14px);
  flex-shrink: 0; /* Don't allow shrinking */
  min-height: var(--min-piles-height); /* Ensure piles remain visible */
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

.piles-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: clamp(4px, 0.8vw, 8px);
  width: 100%;
}

.pile-item {
  background: rgba(255, 255, 255, 0.02);
  border-radius: clamp(6px, 1vw, 8px);
  padding: clamp(6px, 1vw, 10px);
  text-align: center;
  font-size: clamp(9px, 1.2vw, 11px);
  color: var(--text-secondary);
}

.pile-item span {
  display: block;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 4px;
}

.pile-item strong {
  display: block;
  font-size: 14px;
  color: var(--text-primary);
  font-weight: 600;
}

.info-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
  height: 100%;
}

.info-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.info-header h3 {
  font-family: var(--font-display);
  letter-spacing: 0.04em;
  color: var(--gold-light);
}

.info-section {
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: 12px;
  padding: 14px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.info-section h3 {
  font-family: var(--font-display);
  letter-spacing: 0.04em;
  color: var(--gold-light);
}

.inspector-content {
  font-size: 13px;
  color: var(--text-secondary);
  max-height: 900px;
  font-size: 40px;
  overflow-y: auto; /* Allow scrolling if content is too tall */
}

.log-content {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 900px;
  padding-right: 6px;
}

.piles-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
}

.pile-item {
  background: rgba(255, 255, 255, 0.02);
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  font-size: 12px;
  color: var(--text-secondary);
}

.pile-item strong {
  display: block;
  font-size: 16px;
  color: var(--text-primary);
  margin-top: 4px;
}

.action-bar {
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1vw, 12px);
  padding: clamp(4px, 0.8vw, 8px) clamp(10px, 1.5vw, 20px) clamp(6px, 1vw, 12px);
  height: 0;
  pointer-events: none;
  border-top: none;
  background: transparent;
  width: clamp(320px, 42vw, 680px);
  max-width: 100%;
  position: fixed;
  bottom: calc(0px + var(--safe-bottom));
  left: 50%;
  transform: translateX(-50%);
  right: auto;
  overflow: hidden;
  box-sizing: border-box;
  transform-origin: bottom center;
  z-index: 12;
}

.action-bar.has-selection,
.action-bar.has-actions {
  padding: clamp(6px, 1vw, 12px) clamp(10px, 1.5vw, 20px) clamp(8px, 1.2vw, 16px);
  height: auto;
  max-height: 50vh;
  pointer-events: auto;
  background: rgba(10, 14, 20, 0.96);
  border-top: 1px solid var(--border-subtle);
  overflow-y: auto;
  overflow-x: hidden;
  box-sizing: border-box;
}

/* Widen action bar for card selection grids */
.action-bar.has-selection:has(.selection-card) {
  width: clamp(360px, 85vw, 720px);
  max-width: 90vw;
}

.action-buttons {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: clamp(8px, 1.2vw, 14px);
  width: 100%;
  max-width: min(400px, 90%);
  margin: 0 auto;
}

.action-btn {
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: clamp(8px, 1.2vw, 14px);
  padding: clamp(8px, 1.2vw, 14px) clamp(10px, 1.5vw, 18px);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: clamp(6px, 1vw, 10px);
  font-weight: 600;
  font-size: clamp(11px, 1.4vw, 14px);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
  width: 100%;
  min-height: clamp(32px, 5vh, 44px);
}

.action-btn.primary {
  background: linear-gradient(135deg, var(--gold), var(--gold-dark));
  color: #2e2211;
  border: none;
}

.action-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.action-btn:hover:not(:disabled) {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.35);
}

.selection-panel,
.action-panel {
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1vw, 10px);
  font-size: clamp(12px, 1.6vw, 15px);
  width: 100%;
  max-width: 100%;
}

.action-panel {
  align-items: center;
}

.action-panel .action-buttons {
  width: min(260px, 100%);
  grid-template-columns: minmax(0, 1fr);
  justify-items: center;
  max-width: min(300px, 90%);
}

.action-panel .action-btn {
  padding: clamp(4px, 0.8vw, 8px) clamp(10px, 1.5vw, 16px);
  min-height: clamp(28px, 4vh, 36px);
  width: 100%;
  max-width: 100%;
}

.selection-panel {
  font-size: clamp(12px, 1.6vw, 15px);
  width: 100%;
  max-width: 100%;
}

@keyframes active-breathe {
  0%,
  100% {
    box-shadow: 0 0 0 rgba(240, 208, 120, 0.15);
  }
  50% {
    box-shadow: 0 0 18px rgba(240, 208, 120, 0.45);
  }
}

.selection-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.selection-item {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--bg-card);
  padding: 6px 8px;
  border-radius: 8px;
}

.selection-item.selection-card {
  flex-direction: column;
  align-items: center;
}

.selection-item.selection-card .card {
  width: clamp(140px, 35vw, 200px);
  max-width: 200px;
}

.selection-item button {
  background: var(--bg-card-hover);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  padding: 4px 8px;
  font-size: 12px;
}

/* Option bubble styles for discrete effect choices */
.selection-item.option-bubble {
  flex-direction: column;
  align-items: stretch;
  padding: 0;
}

.option-bubble-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-card-hover) 100%);
  border: 2px solid var(--border-gold);
  border-radius: 12px;
  padding: 12px 16px;
  min-width: 140px;
  cursor: pointer;
  transition: all var(--transition-fast);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.option-bubble-btn:hover {
  background: linear-gradient(135deg, var(--bg-card-hover) 0%, rgba(212, 168, 83, 0.15) 100%);
  border-color: var(--gold-light);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(212, 168, 83, 0.25);
}

.option-bubble-btn:active {
  transform: translateY(0);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}

.option-bubble-btn .option-label {
  font-size: 14px;
  font-weight: 600;
  color: var(--gold-light);
  text-align: center;
}

.option-bubble-btn .option-description {
  font-size: 11px;
  color: var(--text-muted);
  text-align: center;
  line-height: 1.3;
}

/* Selection list layout for option bubbles */
.selection-list:has(.option-bubble) {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
}

/* Selection list grid layout for card selections */
.selection-list:has(.selection-card) {
  display: grid;
  grid-template-columns: repeat(2, minmax(130px, 1fr));
  gap: 12px;
  max-width: 100%;
  justify-items: center;
}

/* Tablet: 2-3 columns */
@media (min-width: 540px) {
  .selection-list:has(.selection-card) {
    grid-template-columns: repeat(auto-fit, minmax(150px, 200px));
    justify-content: center;
  }
}

/* Desktop: 3 columns */
@media (min-width: 768px) {
  .selection-list:has(.selection-card) {
    grid-template-columns: repeat(3, minmax(160px, 200px));
    justify-content: center;
  }
}

/* Smaller cards in grid for better fit */
.selection-list:has(.selection-card) .selection-item.selection-card {
  width: 100%;
  max-width: 180px;
  padding: 8px;
}

.selection-list:has(.selection-card) .selection-item.selection-card .card {
  width: 100%;
  max-width: 160px;
}

.selection-list:has(.selection-card) .selection-item.selection-card button {
  width: 100%;
  margin-top: 6px;
  padding: 8px 12px;
}

/* Mobile: ensure cards don't get too small */
@media (max-width: 480px) {
  .selection-list:has(.selection-card) {
    grid-template-columns: repeat(2, minmax(130px, 1fr));
    gap: 8px;
  }

  .selection-list:has(.selection-card) .selection-item.selection-card {
    max-width: 160px;
    padding: 6px;
  }

  .selection-list:has(.selection-card) .selection-item.selection-card .card {
    max-width: 140px;
  }
}

/* Very small screens: single column */
@media (max-width: 320px) {
  .selection-list:has(.selection-card) {
    grid-template-columns: 1fr;
  }
}

/* Selection panel layout for card grids */
.selection-panel:has(.selection-card) {
  align-items: center;
}

/* Title above card selection grid */
.selection-panel:has(.selection-card) > strong {
  text-align: center;
  font-size: 16px;
  margin-bottom: 8px;
  color: var(--gold-light);
}

/* Cancel/Confirm button below card selection grid */
.selection-panel:has(.selection-card) > button {
  margin-top: 12px;
  width: 100%;
  max-width: 200px;
  align-self: center;
  padding: 10px 20px;
}

.secondary {
  background: var(--bg-card-hover);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  padding: 6px 10px;
  font-size: 12px;
}

.page-nav {
  display: none;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 48px;
  height: 80px;
  border: 1px solid var(--border-gold);
  border-radius: 16px;
  background: rgba(10, 14, 20, 0.7);
  color: var(--gold-light);
  z-index: 6;
  transition: background var(--transition-fast), transform var(--transition-fast);
}

.page-nav svg {
  width: 26px;
  height: 26px;
}

.page-nav:hover {
  background: rgba(212, 168, 83, 0.2);
}

.page-nav:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.page-nav-left {
  left: 8px;
}

.page-nav-right {
  right: 8px;
}

.page-dots {
  display: none;
  position: absolute;
  bottom: 90px;
  left: 50%;
  transform: translateX(-50%);
  gap: 10px;
  z-index: 6;
}

.page-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  border: 1px solid var(--gold);
  background: transparent;
  transition: transform var(--transition-fast), background var(--transition-fast);
}

.page-dot.active {
  transform: scale(1.2);
  background: var(--gold);
}

.card {
  background: var(--bg-card);
  border-radius: var(--card-radius);
  border: 2px solid #000;
  position: relative;
  overflow: hidden;
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
  aspect-ratio: 5 / 7; /* Standard playing card ratio */
  width: 100%;
}

.card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--mana-blue);
}

.card.type-predator::before {
  background: var(--predator);
}

.card.type-prey::before {
  background: var(--prey);
}

.card.type-spell::before {
  background: var(--spell);
}

.card.type-free-spell::before {
  background: var(--freespell);
}

.card.type-trap::before {
  background: var(--trap);
}

.card-inner {
  padding: 0;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
}

.card-header {
  padding: 8px 10px;
  flex-shrink: 0;
  background: rgba(0, 0, 0, 0.3);
  border-bottom: 1px solid var(--border-subtle);
}

/* Card name: ~8% of card height */
.card-name {
  font-weight: 600;
  font-size: 12px;
  text-align: center;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  padding: 4px 6px;
  background: rgba(0, 0, 0, 0.4);
  flex: 0 0 8%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-type-label {
  display: none; /* Type info removed from card UI - handled by card border color */
}

/* Stats row: ~10% of card height */
.card-stats-row {
  display: flex;
  gap: 0;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
  flex: 0 0 10%;
  padding: 0 4px;
  background: rgba(0, 0, 0, 0.3);
}

/* When only 2 stats (no nutrition), split row in half */
.card-stats-row.two-stats {
  justify-content: space-around;
}

.card-stats-row.two-stats .card-stat {
  flex: 1;
  text-align: center;
}

.card-stat {
  font-size: 12px;
  padding: 2px 8px;
  white-space: nowrap;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
}

.card-stat.atk {
  color: var(--atk-yellow);
}

.card-stat.hp {
  color: var(--hp-red);
}

.card-stat.nut {
  color: var(--prey);
}

.card-keywords {
  display: flex;
  flex-wrap: wrap;
  gap: 2px;
  font-size: 10px;
  color: var(--text-primary);
  justify-content: center;
  text-align: center;
  align-items: center;
}

.card-keywords span {
  font-weight: bold;
  text-decoration: underline;
  padding: 0 2px;
}

.card-effect {
  font-size: 9px;
  color: var(--text-secondary);
  line-height: 1.2;
  text-align: center;
}

/* Image container: ~50% of card height */
.card-image-container {
  flex: 0 0 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.5);
  overflow: hidden;
  position: relative;
}

.card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.card-image-placeholder {
  font-size: 24px;
  opacity: 0.6;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-footer {
  padding: 8px 10px;
  flex-shrink: 0;
  background: rgba(0, 0, 0, 0.3);
  border-top: 1px solid var(--border-subtle);
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.card-footer .card-stats-row {
  display: flex;
  gap: 6px;
  justify-content: center;
  align-items: stretch;
}

.card-stat-box {
  flex: 1;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 4px;
  padding: 2px 4px;
  min-width: 0;
}

.card-stat-box .stat-emoji {
  font-size: 14px;
  line-height: 1;
}

.card-stat-box .stat-value {
  font-size: 14px;
  font-weight: 700;
  line-height: 1;
  color: #fff;
  text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000,
    -2px 0 0 #000,
    2px 0 0 #000,
    0 -2px 0 #000,
    0 2px 0 #000;
}

.card-text-area {
  font-size: 10px;
  line-height: 1.3;
  color: var(--text-secondary);
  text-align: center;
  white-space: pre-line;
  word-wrap: break-word;
  overflow-wrap: break-word;
  padding: 2px 4px;
}

.card-text-area strong {
  font-weight: 600;
  color: var(--text-primary);
}

.card-text-area u {
  text-decoration: underline;
  color: var(--text-primary);
}

/* Content area: ~32% of card height (stats + keywords + effect) */
.card-content-area {
  flex: 0 0 32%;
  display: flex;
  flex-direction: column;
  gap: 0;
  overflow: hidden;
}

.card-content-area .card-stats-row {
  flex: 0 0 30%; /* ~10% of card = 30% of content area */
}

.card-content-area .card-keywords {
  flex: 0 0 20%; /* Keywords section */
  padding: 2px 4px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-content-area .card-effect {
  flex: 1 1 50%; /* Effect takes remaining space */
  overflow: hidden;
  padding: 2px 4px;
  display: flex;
  align-items: flex-start;
  justify-content: center;
}

.card-actions {
  margin-top: auto;
  display: flex;
  gap: 6px;
}

.card-actions button {
  flex: 1;
  padding: 5px 6px;
  border-radius: 6px;
  font-size: 11px;
  background: var(--bg-card-hover);
  border: 1px solid var(--border-subtle);
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.35);
}

/* Disable CSS hover for hand cards - JS proximity detection handles this via .hand-focus class */
/* Must explicitly keep base transform to prevent any hover-induced movement */
.hand-grid .card:hover:not(.hand-focus) {
  transform: translateY(8px) scale(0.98); /* Same as base - no change on hover */
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.35); /* Same as base */
}

.card.card-selected {
  border: 3px solid var(--gold);
  box-shadow: 0 0 20px rgba(212, 168, 83, 0.8), 0 6px 16px rgba(0, 0, 0, 0.35);
}

.card.back {
  display: grid;
  place-items: center;
  font-size: 12px;
  color: var(--text-muted);
}

.card-status {
  position: absolute;
  top: 6px;
  right: 6px;
  font-size: 12px;
}

.card-hit {
  animation: card-hit 0.4s ease-out;
}

.damage-pop {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: var(--font-display);
  font-size: 26px;
  color: #ff3b3b;
  text-shadow: 0 0 10px rgba(255, 59, 59, 0.75);
  animation: damage-pop 0.9s ease-out forwards;
  pointer-events: none;
  z-index: 3;
}

.attack-ghost {
  position: absolute;
  transform: translate(-50%, -50%);
  pointer-events: none;
  filter: drop-shadow(0 12px 22px rgba(0, 0, 0, 0.45));
  z-index: 4;
}

.attack-ghost--slot {
  border-radius: var(--card-radius);
  background: rgba(255, 255, 255, 0.08);
  border: 1px dashed rgba(255, 255, 255, 0.2);
}

.impact-ring {
  position: absolute;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 2px solid rgba(255, 165, 120, 0.8);
  box-shadow: 0 0 18px rgba(255, 115, 80, 0.6);
  transform: translate(-50%, -50%);
  animation: impact-ring 0.5s ease-out forwards;
  pointer-events: none;
  z-index: 3;
}

@keyframes damage-pop {
  0% {
    transform: translate(-50%, -50%) scale(0.6);
    opacity: 0;
  }
  25% {
    transform: translate(-50%, -60%) scale(1.15);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -110%) scale(0.9);
    opacity: 0;
  }
}

@keyframes card-hit {
  0% {
    box-shadow: 0 0 0 rgba(255, 80, 80, 0.6);
  }
  50% {
    box-shadow: 0 0 22px rgba(255, 80, 80, 0.8);
  }
  100% {
    box-shadow: 0 0 0 rgba(255, 80, 80, 0);
  }
}

@keyframes impact-ring {
  0% {
    transform: translate(-50%, -50%) scale(0.4);
    opacity: 0.95;
  }
  100% {
    transform: translate(-50%, -50%) scale(1.25);
    opacity: 0;
  }
}

/* ============================================================================
   CONSUMPTION EFFECTS
   ============================================================================ */

.consumption-ghost {
  position: absolute;
  transform: translate(-50%, -50%);
  pointer-events: none;
  filter: drop-shadow(0 8px 16px rgba(39, 174, 96, 0.4));
  z-index: 4;
}

.consumption-ghost--slot {
  width: 60px;
  height: 80px;
  background: linear-gradient(135deg, rgba(39, 174, 96, 0.6), rgba(39, 174, 96, 0.3));
  border-radius: var(--card-radius);
  border: 2px solid rgba(39, 174, 96, 0.8);
}

.consumption-complete {
  animation: consumption-complete 0.4s ease-out;
}

@keyframes consumption-complete {
  0% {
    box-shadow: 0 0 0 rgba(39, 174, 96, 0);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 25px rgba(39, 174, 96, 0.8), inset 0 0 15px rgba(39, 174, 96, 0.3);
    transform: scale(1.05);
  }
  100% {
    box-shadow: 0 0 0 rgba(39, 174, 96, 0);
    transform: scale(1);
  }
}

.nutrition-pop {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: var(--font-display);
  font-size: 22px;
  color: #27ae60;
  text-shadow: 0 0 10px rgba(39, 174, 96, 0.8), 0 0 20px rgba(39, 174, 96, 0.5);
  animation: nutrition-pop 1s ease-out forwards;
  pointer-events: none;
  z-index: 5;
  white-space: nowrap;
}

@keyframes nutrition-pop {
  0% {
    transform: translate(-50%, -50%) scale(0.5);
    opacity: 0;
  }
  20% {
    transform: translate(-50%, -60%) scale(1.2);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -120%) scale(1);
    opacity: 0;
  }
}

/* ============================================================================
   KEYWORD TRIGGER EFFECTS
   ============================================================================ */

.keyword-indicator {
  position: absolute;
  font-size: 36px;
  transform: translate(-50%, -50%);
  animation: keyword-indicator 0.8s ease-out forwards;
  pointer-events: none;
  z-index: 5;
}

@keyframes keyword-indicator {
  0% {
    transform: translate(-50%, -50%) scale(0.3);
    opacity: 0;
  }
  25% {
    transform: translate(-50%, -60%) scale(1.3);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -100%) scale(1);
    opacity: 0;
  }
}

/* Barrier - Blue shield shimmer */
.keyword-barrier {
  animation: keyword-barrier-glow 0.6s ease-out;
}

@keyframes keyword-barrier-glow {
  0% {
    box-shadow: 0 0 0 rgba(79, 195, 247, 0), inset 0 0 0 rgba(79, 195, 247, 0);
  }
  30% {
    box-shadow: 0 0 30px rgba(79, 195, 247, 0.8), inset 0 0 20px rgba(79, 195, 247, 0.4);
  }
  100% {
    box-shadow: 0 0 0 rgba(79, 195, 247, 0), inset 0 0 0 rgba(79, 195, 247, 0);
  }
}

/* Ambush - Orange flash */
.keyword-ambush {
  animation: keyword-ambush-flash 0.5s ease-out;
}

@keyframes keyword-ambush-flash {
  0% {
    box-shadow: 0 0 0 rgba(255, 112, 67, 0);
    filter: brightness(1);
  }
  40% {
    box-shadow: 0 0 25px rgba(255, 112, 67, 0.9);
    filter: brightness(1.3);
  }
  100% {
    box-shadow: 0 0 0 rgba(255, 112, 67, 0);
    filter: brightness(1);
  }
}

/* Toxic - Green poison glow */
.keyword-toxic {
  animation: keyword-toxic-glow 0.6s ease-out;
}

@keyframes keyword-toxic-glow {
  0% {
    box-shadow: 0 0 0 rgba(118, 255, 3, 0);
  }
  30% {
    box-shadow: 0 0 30px rgba(118, 255, 3, 0.8), 0 0 50px rgba(118, 255, 3, 0.4);
  }
  100% {
    box-shadow: 0 0 0 rgba(118, 255, 3, 0);
  }
}

/* Neurotoxic - Ice blue freeze effect */
.keyword-neurotoxic {
  animation: keyword-neurotoxic-freeze 0.7s ease-out;
}

@keyframes keyword-neurotoxic-freeze {
  0% {
    box-shadow: 0 0 0 rgba(128, 222, 234, 0);
    filter: hue-rotate(0deg);
  }
  40% {
    box-shadow: 0 0 35px rgba(128, 222, 234, 0.9), inset 0 0 20px rgba(128, 222, 234, 0.5);
    filter: hue-rotate(-20deg);
  }
  100% {
    box-shadow: 0 0 0 rgba(128, 222, 234, 0);
    filter: hue-rotate(0deg);
  }
}

/* Scavenge - Brown earthy glow */
.keyword-scavenge {
  animation: keyword-scavenge-glow 0.5s ease-out;
}

@keyframes keyword-scavenge-glow {
  0% {
    box-shadow: 0 0 0 rgba(161, 136, 127, 0);
  }
  50% {
    box-shadow: 0 0 25px rgba(161, 136, 127, 0.8);
  }
  100% {
    box-shadow: 0 0 0 rgba(161, 136, 127, 0);
  }
}

/* Haste - Yellow lightning flash */
.keyword-haste {
  animation: keyword-haste-flash 0.4s ease-out;
}

@keyframes keyword-haste-flash {
  0% {
    box-shadow: 0 0 0 rgba(255, 235, 59, 0);
    filter: brightness(1);
  }
  30% {
    box-shadow: 0 0 30px rgba(255, 235, 59, 0.9);
    filter: brightness(1.4);
  }
  100% {
    box-shadow: 0 0 0 rgba(255, 235, 59, 0);
    filter: brightness(1);
  }
}

/* Lure - Pink attractive glow */
.keyword-lure {
  animation: keyword-lure-glow 0.5s ease-out;
}

@keyframes keyword-lure-glow {
  0% {
    box-shadow: 0 0 0 rgba(240, 98, 146, 0);
  }
  50% {
    box-shadow: 0 0 25px rgba(240, 98, 146, 0.8), 0 0 40px rgba(240, 98, 146, 0.4);
  }
  100% {
    box-shadow: 0 0 0 rgba(240, 98, 146, 0);
  }
}

/* Generic keyword trigger fallback */
.keyword-trigger-generic {
  animation: keyword-generic-pulse 0.5s ease-out;
}

@keyframes keyword-generic-pulse {
  0% {
    box-shadow: 0 0 0 rgba(212, 168, 83, 0);
  }
  50% {
    box-shadow: 0 0 20px rgba(212, 168, 83, 0.7);
  }
  100% {
    box-shadow: 0 0 0 rgba(212, 168, 83, 0);
  }
}

/* ============================================================================
   TURN PULSE - Playable cards glow
   ============================================================================ */

.card.playable-pulse {
  animation: playable-pulse 2s ease-in-out infinite;
}

@keyframes playable-pulse {
  0%, 100% {
    box-shadow: 0 0 0 rgba(212, 168, 83, 0.3);
  }
  50% {
    box-shadow: 0 0 15px rgba(212, 168, 83, 0.6), 0 0 25px rgba(212, 168, 83, 0.3);
  }
}

/* Different pulse for creatures that can attack */
.card.can-attack-pulse {
  animation: can-attack-pulse 1.5s ease-in-out infinite;
}

@keyframes can-attack-pulse {
  0%, 100% {
    box-shadow: 0 0 0 rgba(231, 76, 60, 0.3);
  }
  50% {
    box-shadow: 0 0 12px rgba(231, 76, 60, 0.6), 0 0 20px rgba(231, 76, 60, 0.3);
  }
}

.overlay {
  position: fixed;
  inset: 0;
  background: var(--bg-overlay);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--transition-medium);
  z-index: 20;
  padding: 24px;
}

.overlay.active {
  opacity: 1;
  pointer-events: auto;
}

.overlay-content {
  background: var(--bg-card);
  border: 1px solid var(--border-gold);
  border-radius: 18px;
  padding: 20px;
  width: min(1200px, 100%);
  max-height: 90vh;
  overflow: hidden;
  transform: scale(0.96);
  transition: transform var(--transition-medium);
}

.overlay.active .overlay-content {
  transform: scale(1);
}

.menu-card {
  width: min(520px, 100%);
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.menu-header {
  display: flex;
  gap: 16px;
  align-items: center;
}

.menu-icon {
  font-size: 32px;
  background: rgba(255, 255, 255, 0.08);
  border-radius: 14px;
  padding: 10px 14px;
  border: 1px solid var(--border-subtle);
}

.menu-status {
  font-size: 14px;
  color: var(--text-secondary);
  background: rgba(255, 255, 255, 0.04);
  border-radius: 12px;
  padding: 12px 14px;
  border: 1px solid var(--border-subtle);
}

.menu-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.tutorial-card {
  width: 100%;
  height: 100%;
  max-height: 100%;
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 24px;
}

.tutorial-overlay {
  padding: 0;
}

.tutorial-overlay .overlay-content {
  width: 100%;
  height: 100%;
  max-height: 100%;
}

.tutorial-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 16px;
}

.tutorial-header h2 {
  margin: 6px 0 4px;
  font-family: var(--font-display);
  letter-spacing: 0.04em;
}

.tutorial-eyebrow {
  text-transform: uppercase;
  font-size: 12px;
  letter-spacing: 0.2em;
  color: var(--text-muted);
  margin: 0;
}

.tutorial-scroll {
  flex: 1;
  overflow-y: auto;
  padding-right: 12px;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.tutorial-section {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--border-subtle);
  border-radius: 16px;
  padding: 18px;
}

.tutorial-section h3 {
  margin-top: 0;
  font-size: 20px;
}

.tutorial-diagram {
  margin-top: 12px;
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
}

.focus-diagram .focus-card {
  flex: 1;
  min-width: 180px;
  background: rgba(0, 0, 0, 0.4);
  border-radius: 14px;
  padding: 16px;
  border: 1px solid var(--border-subtle);
}

.focus-card-title {
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--text-muted);
}

.focus-card-value {
  font-size: 22px;
  font-weight: 600;
  margin: 8px 0;
}

.focus-card-caption {
  font-size: 13px;
  color: var(--text-secondary);
}

.focus-arrow {
  font-size: 20px;
  color: var(--text-muted);
}

.card-anatomy .stat-card {
  background: rgba(12, 14, 20, 0.7);
  border-radius: 16px;
  padding: 16px;
  border: 1px solid var(--border-subtle);
  min-width: 180px;
}

.stat-row {
  display: flex;
  justify-content: space-between;
  padding: 6px 0;
  font-size: 14px;
}

.stat-label {
  color: var(--text-muted);
}

.stat-value {
  font-weight: 700;
  color: #f9d77e;
}

.stat-footer {
  margin-top: 8px;
  font-size: 12px;
  color: var(--text-secondary);
}

.stat-explain {
  flex: 1;
  min-width: 200px;
  font-size: 14px;
  color: var(--text-secondary);
}

.stat-pulse {
  position: relative;
}

.stat-pulse::after {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: 12px;
  border: 1px solid rgba(249, 215, 126, 0.6);
  box-shadow: 0 0 12px rgba(249, 215, 126, 0.6);
  animation: statPulse 2.4s ease-in-out infinite;
}

@keyframes statPulse {
  0%,
  100% {
    opacity: 0.3;
    transform: scale(0.98);
  }
  50% {
    opacity: 0.9;
    transform: scale(1.02);
  }
}

.zone-diagram .zone-block,
.spell-diagram .spell-card {
  flex: 1;
  min-width: 180px;
  background: rgba(0, 0, 0, 0.35);
  border: 1px solid var(--border-subtle);
  border-radius: 12px;
  padding: 14px;
}

.turn-flow {
  flex-wrap: nowrap;
  overflow-x: auto;
  padding-bottom: 8px;
}

.flow-step {
  background: rgba(0, 0, 0, 0.35);
  border-radius: 999px;
  padding: 10px 14px;
  border: 1px solid var(--border-subtle);
  white-space: nowrap;
  font-size: 13px;
}

.flow-arrow {
  color: var(--text-muted);
  font-size: 18px;
}

.tutorial-note {
  margin-top: 10px;
  font-size: 13px;
  color: var(--text-secondary);
}

.combat-diagram {
  flex-direction: column;
  align-items: stretch;
}

.combat-card {
  background: rgba(0, 0, 0, 0.4);
  border-radius: 12px;
  padding: 12px 14px;
  border: 1px solid var(--border-subtle);
}

.combat-connector {
  text-align: center;
  font-size: 22px;
}

.combat-result {
  font-size: 13px;
  color: var(--text-secondary);
}

.consume-diagram {
  flex-wrap: wrap;
}

.consume-prey,
.consume-predator {
  background: rgba(0, 0, 0, 0.35);
  border-radius: 12px;
  padding: 12px 14px;
  border: 1px solid var(--border-subtle);
}

.consume-predator {
  background: rgba(76, 29, 149, 0.35);
  border-color: rgba(240, 208, 120, 0.4);
}

.tutorial-list {
  margin: 0;
  padding-left: 20px;
  color: var(--text-secondary);
}

.tutorial-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 12px;
  font-size: 13px;
  color: var(--text-secondary);
}

.btn-secondary {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid var(--border-subtle);
  border-radius: 12px;
  padding: 12px 16px;
  font-weight: 600;
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}

.btn-primary:hover:not(:disabled),
.btn-secondary:hover:not(:disabled) {
  transform: translateY(-1px);
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.3);
}

.menu-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.multiplayer-overlay .menu-form {
  display: none;
}

.multiplayer-overlay .menu-form.active {
  display: flex;
}

.menu-label {
  font-size: 13px;
  color: var(--text-secondary);
}

.menu-input {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  padding: 10px 12px;
  color: var(--text-primary);
}

.menu-input:focus {
  outline: 2px solid rgba(240, 208, 120, 0.5);
  outline-offset: 2px;
}

.menu-error {
  min-height: 20px;
  font-size: 13px;
  color: #f87171;
}

.lobby-code {
  font-family: var(--font-display);
  font-size: 28px;
  letter-spacing: 0.2em;
  text-align: center;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.06);
}

/* ============================================================================
   AI SETUP OVERLAY
   ============================================================================ */

.ai-setup-overlay .menu-card {
  max-width: 480px;
}

.ai-setup-section {
  margin-bottom: 20px;
}

.ai-setup-label {
  font-family: var(--font-display);
  font-size: 14px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-secondary);
  margin-bottom: 12px;
}

.ai-difficulty-buttons {
  display: flex;
  gap: 12px;
}

.btn-difficulty {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 16px 12px;
  border-radius: 12px;
  border: 2px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.04);
  color: var(--text-primary);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.btn-difficulty:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.15);
}

.btn-difficulty.active {
  border-color: var(--gold);
  background: rgba(212, 168, 83, 0.15);
}

.difficulty-icon {
  font-size: 28px;
}

.difficulty-name {
  font-family: var(--font-display);
  font-size: 16px;
  letter-spacing: 0.05em;
}

.difficulty-desc {
  font-size: 11px;
  color: var(--text-muted);
  text-align: center;
}

.ai-deck-options {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
}

.btn-deck-option {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 16px;
  border-radius: 12px;
  border: 2px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.04);
  color: var(--text-primary);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.btn-deck-option:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.15);
}

.btn-deck-option.active {
  border-color: var(--gold);
  background: rgba(212, 168, 83, 0.15);
}

.deck-option-icon {
  font-size: 22px;
}

.deck-option-name {
  font-size: 14px;
}

.ai-saved-decks {
  margin-top: 12px;
}

.menu-select {
  width: 100%;
  padding: 12px 16px;
  border-radius: 10px;
  border: 1px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.06);
  color: var(--text-primary);
  font-family: var(--font-body);
  font-size: 14px;
  cursor: pointer;
}

.menu-select:focus {
  outline: none;
  border-color: var(--gold);
}

.menu-select option {
  background: var(--bg-card);
  color: var(--text-primary);
}

.deck-select-card {
  display: flex;
  flex-direction: column;
  gap: 20px;
  height: 100%;
}

.deck-select-header {
  display: flex;
  gap: 16px;
  align-items: center;
}

.deck-select-icon {
  font-size: 32px;
  background: rgba(255, 255, 255, 0.06);
  border-radius: 14px;
  padding: 10px 14px;
  border: 1px solid var(--border-subtle);
}

.deck-select-header h2 {
  font-family: var(--font-display);
  letter-spacing: 0.05em;
  margin: 0 0 6px;
}

.deck-select-header p {
  margin: 0;
  color: var(--text-secondary);
}

.deck-select-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 16px;
  overflow-y: auto;
  padding-right: 6px;
}

.deck-select-panel {
  border-radius: 16px;
  padding: 16px;
  border: 1px solid transparent;
  min-height: 140px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  text-align: left;
  color: #f4f4f4;
  background: rgba(255, 255, 255, 0.06);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}

.deck-select-panel .deck-emoji {
  font-size: 28px;
}

.deck-select-panel .deck-name {
  font-size: 18px;
  font-weight: 600;
}

.deck-select-panel .deck-status {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.85);
}

.deck-select-panel .deck-meta {
  margin-top: auto;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.deck-select-panel:hover:not(.disabled),
.deck-select-panel:focus-visible:not(.disabled) {
  transform: translateY(-2px);
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
  border-color: rgba(255, 255, 255, 0.4);
}

.deck-select-panel.disabled {
  opacity: 0.5;
  cursor: not-allowed;
  border-style: dashed;
}

.deck-select-panel--fish {
  background: linear-gradient(135deg, rgba(54, 108, 180, 0.9), rgba(18, 40, 72, 0.95));
}

.deck-select-panel--bird {
  background: linear-gradient(135deg, rgba(200, 160, 40, 0.85), rgba(83, 52, 12, 0.95));
}

.deck-select-panel--mammal {
  background: linear-gradient(135deg, rgba(140, 92, 68, 0.85), rgba(60, 36, 24, 0.95));
}

.deck-select-panel--reptile {
  background: linear-gradient(135deg, rgba(60, 142, 74, 0.85), rgba(22, 66, 35, 0.95));
}

.deck-select-panel--amphibian {
  background: linear-gradient(135deg, rgba(92, 180, 116, 0.85), rgba(26, 92, 54, 0.95));
}

.deck-builder {
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: calc(90vh - 40px);
  overflow: hidden;
}

.deck-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  flex-shrink: 0;
}

.deck-header h2 {
  font-family: var(--font-display);
  letter-spacing: 0.05em;
}

.deck-status {
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-size: 12px;
  color: var(--text-secondary);
}

.deck-status-item.invalid {
  color: var(--hp-red);
}

.deck-status-success {
  color: #4caf50;
  font-weight: 600;
  padding: 4px 8px;
  background: rgba(76, 175, 80, 0.15);
  border-radius: 4px;
  margin-top: 4px;
}

.deck-status-error {
  color: var(--hp-red);
  font-weight: 600;
  padding: 4px 8px;
  background: rgba(244, 67, 54, 0.15);
  border-radius: 4px;
  margin-top: 4px;
}

.deck-tabs {
  display: flex;
  gap: 8px;
  flex-shrink: 0;
}

.deck-tab {
  flex: 1;
  padding: 8px;
  border-radius: 10px;
  border: 1px solid var(--border-subtle);
  background: var(--bg-card);
  color: var(--text-secondary);
}

.deck-tab.active {
  color: var(--gold-light);
  border-color: var(--border-gold);
}

.deck-tab.hidden {
  display: none;
}

.deck-content {
  flex: 1;
  display: grid;
  min-height: 0;
  overflow: auto;
}

.deck-panel {
  display: none;
}

.deck-panel.active {
  display: block;
}

.deck-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 12px;
  max-height: 400px;
  overflow: auto;
  padding-right: 4px;
  padding-bottom: 8px;
}

/* Mobile deck builder - 2 column grid with properly sized cards */
@media (max-width: 500px) {
  .deck-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    padding: 4px;
  }

  .deck-grid .card {
    width: 100%;
    min-height: 180px;
    aspect-ratio: 5 / 7;
  }
}

.deck-card {
  cursor: pointer;
}

.deck-card.highlighted {
  border-color: var(--gold);
  box-shadow: 0 0 12px rgba(212, 168, 83, 0.6);
}

.deck-card.selected::after {
  content: "Selected";
  position: absolute;
  bottom: 6px;
  right: 6px;
  background: rgba(0, 0, 0, 0.5);
  padding: 2px 6px;
  font-size: 10px;
  border-radius: 6px;
}

.deck-inspector {
  background: var(--bg-field);
  border-radius: 12px;
  padding: 12px;
  font-size: 12px;
  color: var(--text-secondary);
  max-height: 120px;
  overflow: auto;
  flex-shrink: 0;
}

.deck-actions {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  flex-shrink: 0;
  padding-top: 8px;
}

.deck-actions button {
  flex: 1;
  min-width: 100px;
}

.deck-exit {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  padding: 10px 14px;
  font-weight: 600;
  color: var(--text-secondary);
}

.deck-save {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  padding: 10px 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.deck-save.hidden {
  display: none;
}

.deck-load {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  padding: 10px 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.deck-load.hidden {
  display: none;
}

.deck-load-list,
.deck-manage-list {
  display: grid;
  gap: 12px;
  flex: 1;
  min-height: 0;
  overflow: auto;
  padding-right: 4px;
}

.deck-slot {
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: 12px;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.deck-slot-header {
  display: flex;
  justify-content: space-between;
  gap: 12px;
  font-weight: 600;
}

.deck-slot-meta {
  font-size: 12px;
  color: var(--text-secondary);
}

.deck-slot-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.deck-slot-actions button {
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid var(--border-subtle);
  background: var(--bg-card-hover);
  font-size: 12px;
  color: var(--text-secondary);
}

.deck-slot-actions button.primary {
  color: var(--text-primary);
  border-color: var(--border-gold);
}

.deck-slot-actions button.danger {
  color: var(--hp-red);
  border-color: rgba(255, 89, 89, 0.6);
}

/* ============================================================================
   DECK CATALOG HOME SCREEN
   Card-based layout for deck management
   ============================================================================ */

.deck-catalog-home {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: flex-start;
  gap: 20px;
  width: 100%;
  max-width: 1000px;
  margin: 0 auto;
  padding: 20px;
}

.deck-catalog-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 24px 16px;
  min-height: 180px;
  width: 180px;
  flex: 0 0 180px;
  background: var(--bg-card);
  border: 2px solid var(--border-subtle);
  border-radius: 16px;
  transition: all 0.2s ease;
  text-align: center;
}

.deck-catalog-card:hover {
  border-color: var(--border-gold);
  background: var(--bg-card-hover);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
}

.deck-catalog-card--view-all {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(147, 51, 234, 0.1));
  border-color: rgba(59, 130, 246, 0.4);
}

.deck-catalog-card--view-all:hover {
  border-color: rgba(59, 130, 246, 0.8);
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.2));
}

.deck-catalog-card--filled {
  border-color: var(--border-gold);
}

.deck-catalog-card--empty {
  border-style: dashed;
  opacity: 0.7;
}

.deck-catalog-card--empty:hover {
  opacity: 1;
}

.deck-catalog-card__icon {
  font-size: 48px;
  line-height: 1;
}

.deck-catalog-card__title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}

.deck-catalog-card__subtitle {
  font-size: 12px;
  color: var(--text-secondary);
}

.deck-catalog-card__actions {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

.deck-catalog-card__btn {
  padding: 8px 12px;
  font-size: 18px;
  background: var(--bg-card-hover);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.deck-catalog-card__btn:hover {
  transform: scale(1.1);
}

.deck-catalog-card__btn--edit:hover {
  border-color: var(--border-gold);
  background: rgba(255, 215, 0, 0.1);
}

.deck-catalog-card__btn--delete:hover {
  border-color: var(--hp-red);
  background: rgba(255, 89, 89, 0.1);
}

.deck-catalog-back-container {
  flex: 0 0 100%;
  display: flex;
  justify-content: center;
  padding-top: 16px;
}

.deck-catalog-back-btn {
  padding: 12px 32px;
  font-size: 14px;
  font-weight: 600;
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
}

.deck-catalog-back-btn:hover {
  color: var(--text-primary);
  border-color: var(--border-gold);
  background: var(--bg-card-hover);
}

.deck-select-back-btn {
  padding: 10px 20px;
  font-size: 14px;
  font-weight: 500;
  background: transparent;
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
  margin-bottom: 8px;
}

.deck-select-back-btn:hover {
  color: var(--text-primary);
  border-color: var(--border-gold);
}

.deck-actions .btn-primary {
  flex: 1;
}

.deck-random {
  flex: 0 0 25%;
  background: var(--bg-card-hover);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  padding: 10px 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-secondary);
}

.deck-random:hover {
  color: var(--gold-light);
  border-color: var(--border-gold);
}

.btn-primary {
  background: linear-gradient(135deg, var(--gold), var(--gold-dark));
  color: #2e2211;
  border-radius: 10px;
  padding: 10px 16px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.setup-card,
.pass-card {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
  text-align: center;
}

.setup-icon,
.pass-icon {
  font-size: 32px;
}

.setup-rolls {
  display: flex;
  flex-direction: column;
  gap: 8px;
  font-size: 14px;
}

.setup-actions {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
}

.setup-button-row {
  display: flex;
  gap: 10px;
  justify-content: center;
}

.setup-actions button {
  background: var(--bg-card-hover);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  padding: 8px 12px;
}

/* Extreme zoom / very small viewports */
@media (max-height: 500px) {
  .game-container {
    min-height: 500px; /* Force minimum height */
    overflow-y: auto; /* Allow vertical scrolling when extremely zoomed */
  }

  .battlefield-layout {
    grid-template-rows: minmax(120px, 2.33fr) minmax(80px, 1fr); /* 70/30 ratio, ensure player field stays visible */
    min-height: 200px; /* Reduced but still visible */
  }

  .battlefield-center-column {
    gap: clamp(6px, 1vw, 12px); /* Tighter gap at extreme zoom */
  }

  .hand-panel {
    min-height: 70px; /* Very compact hand at extreme zoom */
    max-height: 25vh; /* Reduce max to prioritize battlefield */
  }

  .field-slot {
    min-height: clamp(60px, 10vh, 100px); /* Smaller but still usable */
  }

  .card-inspector-panel,
  .game-log-panel {
    min-height: 120px; /* Reduce minimum heights */
  }

  .piles-section {
    min-height: 60px; /* Compact piles */
  }
}

/* Mobile portrait mode - tab-based layout */
@media (max-width: 767px) and (orientation: portrait) {
  .battlefield-layout-three-column {
    grid-template-columns: 1fr;
    overflow: hidden;
    position: relative;
  }

  .battlefield-left-column,
  .battlefield-right-column {
    display: none;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-dark);
    z-index: 5;
    overflow-y: auto;
    padding: 12px;
  }

  .battlefield-layout-three-column.show-inspector .battlefield-left-column {
    display: flex;
    flex-direction: column;
  }

  .battlefield-layout-three-column.show-history .battlefield-right-column {
    display: flex;
    flex-direction: column;
  }

  .battlefield-center-column {
    width: 100%;
    overflow-x: hidden; /* Prevent cards from bleeding off edges */
  }

  .mobile-nav-left,
  .mobile-nav-right {
    display: flex;
  }

  .pages-container {
    padding: 14px 0 0;
    min-height: 450px;
  }

  .hand-panel {
    min-height: clamp(120px, 20vh, 200px);
    max-height: 45vh;
    overflow-x: hidden; /* Clip cards that extend beyond edges */
  }

  .hand-panel.is-dragging {
    overflow: visible !important; /* Allow cards to be visible when dragging */
  }

  .hand-container {
    overflow-x: hidden !important; /* Override visible overflow on mobile */
  }

  .hand-container.is-dragging {
    overflow: visible !important; /* Allow cards to be visible when dragging */
  }

  .hand-grid {
    overflow-x: hidden !important; /* Override visible overflow on mobile */
    padding: 0 clamp(8px, 2vw, 16px); /* Add padding to prevent edge clipping */
  }

  .hand-grid.is-dragging {
    overflow: visible !important; /* Allow cards to be visible when dragging */
  }

  .battlefield-center-column.is-dragging {
    overflow: visible !important; /* Allow cards to be visible when dragging */
  }

  .hand-grid .card {
    width: clamp(140px, 35vw, 200px);
    margin-left: calc(var(--hand-overlap) * -2);
    transform: translateY(8px) scale(calc(0.98 * var(--mobile-card-scale, 1)));
  }

  .hand-grid .card.hand-focus {
    transform: translateY(-40px) scale(calc(1.2 * var(--mobile-card-scale, 1)));
  }

  .card-inspector-panel,
  .game-log-panel {
    min-height: 150px;
    height: 100%;
  }

  /* Fix action bar visibility on mobile */
  .action-bar.has-selection,
  .action-bar.has-actions {
    max-height: 45vh; /* Reduce from 50vh to account for mobile browser chrome */
    padding-bottom: clamp(12px, 2vh, 20px); /* Ensure bottom content is visible */
  }
}

/* Mobile landscape or wider screens */
@media (max-width: 767px) and (orientation: landscape) {
  .battlefield-layout-three-column {
    grid-template-columns: 1fr 2fr 1fr;
    min-width: 100vw;
    min-height: 400px;
    overflow-x: auto;
  }

  .battlefield-left-column,
  .battlefield-center-column,
  .battlefield-right-column {
    min-width: 280px;
  }

  .pages-container {
    padding: 14px 0 0;
    min-height: 450px;
    overflow-x: auto;
  }

  .hand-panel {
    min-height: clamp(90px, 12vh, 120px);
  }

  .card-inspector-panel,
  .game-log-panel {
    min-height: 150px;
  }
}

@media (min-width: 768px) {
  .page-nav,
  .page-dots {
    display: flex;
  }

  .pages-container {
    padding: clamp(16px, 2.5vw, 30px) clamp(30px, 4vw, 80px) 0;
  }

  .action-bar {
    padding: clamp(8px, 1.5vw, 16px) clamp(30px, 4vw, 80px) clamp(12px, 2vw, 24px);
  }

  .hand-panel {
    padding: clamp(8px, 1.5vw, 16px) clamp(12px, 2vw, 24px) clamp(14px, 2vw, 28px);
  }

  .hand-grid .card {
    width: clamp(110px, 14vw, 180px);
  }

  .overlay-content {
    border-radius: 24px;
  }
}

@media (min-width: 1200px) {
  .pages-container {
    padding: clamp(20px, 3vw, 40px) clamp(60px, 5vw, 120px) 0;
  }

  .field-row {
    gap: clamp(12px, 2vw, 24px);
  }

  .field-slot {
    min-height: clamp(140px, 18vh, 220px);
  }

  .action-bar {
    padding: clamp(12px, 2vw, 24px) clamp(60px, 5vw, 120px) clamp(16px, 2.5vw, 32px);
  }
}

@keyframes pulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.03);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes glow {
  0% {
    box-shadow: 0 0 8px rgba(212, 168, 83, 0.3);
  }
  50% {
    box-shadow: 0 0 18px rgba(212, 168, 83, 0.6);
  }
  100% {
    box-shadow: 0 0 8px rgba(212, 168, 83, 0.3);
  }
}

/* Drag and Drop Styles */
.draggable-card {
  cursor: grab;
  transition: transform 0.2s ease, opacity 0.2s ease;
}

/* Prevent child elements from interfering with card drag */
.draggable-card * {
  -webkit-user-drag: none;
  user-drag: none;
}

.draggable-card img {
  pointer-events: none;
}

.draggable-card:hover {
  transform: translateY(-2px);
}

.draggable-card.dragging {
  cursor: grabbing;
  opacity: 0.5;
  transform: rotate(5deg) scale(1.05);
  z-index: 1000;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

/* Valid target highlighting */
.valid-target {
  box-shadow: 0 0 20px rgba(231, 76, 60, 0.8), inset 0 0 20px rgba(231, 76, 60, 0.3);
  border: 2px solid #e74c3c;
  animation: target-pulse 1s infinite;
}

.invalid-target {
  opacity: 0.5;
  pointer-events: none;
}

.consumption-target {
  box-shadow: 0 0 20px rgba(241, 196, 15, 0.8), inset 0 0 20px rgba(241, 196, 15, 0.3);
  border: 2px solid #f1c40f;
  animation: consumption-pulse 1s infinite;
}

@keyframes target-pulse {
  0%, 100% {
    box-shadow: 0 0 20px rgba(231, 76, 60, 0.8), inset 0 0 20px rgba(231, 76, 60, 0.3);
  }
  50% {
    box-shadow: 0 0 30px rgba(231, 76, 60, 1), inset 0 0 30px rgba(231, 76, 60, 0.5);
  }
}

@keyframes consumption-pulse {
  0%, 100% {
    box-shadow: 0 0 20px rgba(241, 196, 15, 0.8), inset 0 0 20px rgba(241, 196, 15, 0.3);
  }
  50% {
    box-shadow: 0 0 30px rgba(241, 196, 15, 1), inset 0 0 30px rgba(241, 196, 15, 0.5);
  }
}

/* Drop zone styles */
.field-slot.valid-drop-zone {
  background: rgba(46, 204, 113, 0.2);
  border: 2px dashed #2ecc71;
  animation: drop-zone-pulse 1s infinite;
}

.player-badge.valid-drop-zone {
  background: rgba(231, 76, 60, 0.2);
  border: 2px dashed #e74c3c;
  animation: player-target-pulse 1s infinite;
}

@keyframes drop-zone-pulse {
  0%, 100% {
    background: rgba(46, 204, 113, 0.2);
    border: 2px dashed #2ecc71;
  }
  50% {
    background: rgba(46, 204, 113, 0.4);
    border: 2px dashed #27ae60;
  }
}

@keyframes player-target-pulse {
  0%, 100% {
    background: rgba(231, 76, 60, 0.2);
    border: 2px dashed #e74c3c;
  }
  50% {
    background: rgba(231, 76, 60, 0.4);
    border: 2px dashed #c0392b;
  }
}

/* Spell target highlighting (blue) */
.spell-target {
  box-shadow: 0 0 20px rgba(52, 152, 219, 0.8), inset 0 0 20px rgba(52, 152, 219, 0.3);
  border: 2px solid #3498db !important;
  animation: spell-target-pulse 1s infinite;
}

.spell-target.card {
  transform: scale(1.02);
}

@keyframes spell-target-pulse {
  0%, 100% {
    box-shadow: 0 0 20px rgba(52, 152, 219, 0.8), inset 0 0 20px rgba(52, 152, 219, 0.3);
    border-color: #3498db;
  }
  50% {
    box-shadow: 0 0 30px rgba(52, 152, 219, 1), inset 0 0 30px rgba(52, 152, 219, 0.5);
    border-color: #2980b9;
  }
}

/* Spell drop zone (player field area) */
.spell-drop-zone {
  background: rgba(52, 152, 219, 0.15) !important;
  border: 2px dashed #3498db !important;
  animation: spell-drop-zone-pulse 1s infinite;
  border-radius: var(--radius);
}

.player-field.spell-drop-zone {
  background: rgba(52, 152, 219, 0.1) !important;
  box-shadow: inset 0 0 30px rgba(52, 152, 219, 0.2);
}

.field-slot.spell-drop-zone {
  background: rgba(52, 152, 219, 0.2) !important;
}

@keyframes spell-drop-zone-pulse {
  0%, 100% {
    background: rgba(52, 152, 219, 0.15);
    border: 2px dashed #3498db;
  }
  50% {
    background: rgba(52, 152, 219, 0.25);
    border: 2px dashed #2980b9;
  }
}

/* Epic Victory Screen Styles */
.victory-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.95) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 1s ease, visibility 1s ease;
}

.victory-overlay.show {
  opacity: 1;
  visibility: visible;
}

.victory-container {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  perspective: 1000px;
}

.victory-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  pointer-events: none;
}

.victory-rays {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 200%;
  height: 200%;
  transform: translate(-50%, -50%);
  background: conic-gradient(
    from 0deg,
    transparent 0deg,
    rgba(212, 168, 83, 0.1) 10deg,
    rgba(212, 168, 83, 0.3) 20deg,
    transparent 30deg,
    transparent 60deg,
    rgba(212, 168, 83, 0.1) 70deg,
    rgba(212, 168, 83, 0.3) 80deg,
    transparent 90deg,
    transparent 120deg,
    rgba(212, 168, 83, 0.1) 130deg,
    rgba(212, 168, 83, 0.3) 140deg,
    transparent 150deg,
    transparent 180deg,
    rgba(212, 168, 83, 0.1) 190deg,
    rgba(212, 168, 83, 0.3) 200deg,
    transparent 210deg,
    transparent 240deg,
    rgba(212, 168, 83, 0.1) 250deg,
    rgba(212, 168, 83, 0.3) 260deg,
    transparent 270deg,
    transparent 300deg,
    rgba(212, 168, 83, 0.1) 310deg,
    rgba(212, 168, 83, 0.3) 320deg,
    transparent 330deg,
    transparent 360deg
  );
  animation: victory-rotate 20s linear infinite;
  opacity: 0;
  transition: opacity 2s ease;
}

.victory-overlay.show .victory-rays {
  opacity: 1;
}

@keyframes victory-rotate {
  from {
    transform: translate(-50%, -50%) rotate(0deg);
  }
  to {
    transform: translate(-50%, -50%) rotate(360deg);
  }
}

.victory-particles {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.victory-particle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: var(--gold);
  border-radius: 50%;
  box-shadow: 0 0 6px var(--gold);
  animation: victory-particle-float 3s ease-in-out infinite;
  pointer-events: none;
}

@keyframes victory-particle-float {
  0%, 100% {
    transform: translateY(100vh) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translateY(-100vh) rotate(720deg);
    opacity: 0;
  }
}

.victory-content {
  position: relative;
  text-align: center;
  color: var(--text-primary);
  z-index: 10;
  transform: scale(0.5) rotateX(90deg);
  opacity: 0;
  transition: all 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  pointer-events: auto;
}

.victory-overlay.show .victory-content {
  transform: scale(1) rotateX(0deg);
  opacity: 1;
}

.victory-crown {
  font-size: 120px;
  margin-bottom: 20px;
  animation: victory-crown-bounce 2s ease-in-out infinite;
  text-shadow: 0 0 30px var(--gold), 0 0 60px var(--gold);
  filter: drop-shadow(0 0 20px var(--gold));
}

@keyframes victory-crown-bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-30px);
  }
  60% {
    transform: translateY(-15px);
  }
}

.victory-title {
  font-family: var(--font-display);
  font-size: 6rem;
  font-weight: 900;
  letter-spacing: 0.2em;
  margin: 0 0 20px 0;
  background: linear-gradient(45deg, var(--gold), var(--gold-light), var(--gold));
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 30px rgba(212, 168, 83, 0.5);
  animation: victory-title-glow 2s ease-in-out infinite alternate;
}

@keyframes victory-title-glow {
  from {
    filter: drop-shadow(0 0 20px var(--gold));
  }
  to {
    filter: drop-shadow(0 0 40px var(--gold-light)) drop-shadow(0 0 60px var(--gold));
  }
}

.victory-winner {
  font-family: var(--font-display);
  font-size: 3rem;
  font-weight: 600;
  margin: 0 0 10px 0;
  color: var(--gold-light);
  text-shadow: 0 0 20px var(--gold);
}

.victory-subtitle {
  font-size: 1.5rem;
  margin: 0 0 40px 0;
  color: var(--text-secondary);
  font-weight: 500;
}

.victory-stats {
  display: flex;
  justify-content: center;
  gap: 40px;
  margin: 40px 0;
  opacity: 0;
  transform: translateY(30px);
  transition: all 1s ease 0.5s;
}

.victory-overlay.show .victory-stats {
  opacity: 1;
  transform: translateY(0);
}

.stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid var(--border-gold);
  border-radius: 15px;
  backdrop-filter: blur(10px);
  min-width: 120px;
}

.stat-label {
  font-size: 0.9rem;
  color: var(--text-secondary);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.stat-value {
  font-family: var(--font-display);
  font-size: 2rem;
  font-weight: 700;
  color: var(--gold);
  text-shadow: 0 0 10px var(--gold);
}

.victory-actions {
  display: flex;
  gap: 20px;
  justify-content: center;
  opacity: 0;
  transform: translateY(30px);
  transition: all 1s ease 1s;
}

.victory-overlay.show .victory-actions {
  opacity: 1;
  transform: translateY(0);
}

.victory-menu {
  background: linear-gradient(135deg, var(--gold), var(--gold-dark));
  color: #2e2211;
  box-shadow: 0 10px 30px rgba(212, 168, 83, 0.3);
  padding: 15px 40px;
  font-size: 1.1rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  z-index: 100;
  pointer-events: auto;
}

.victory-menu:hover {
  transform: translateY(-2px);
  box-shadow: 0 15px 40px rgba(212, 168, 83, 0.5);
}

/* Victory screen entrance animations */
.victory-overlay.show .victory-crown {
  animation-delay: 0.5s;
}

.victory-overlay.show .victory-title {
  animation-delay: 0.8s;
}

.victory-overlay.show .victory-winner {
  animation-delay: 1.1s;
}

.victory-overlay.show .victory-subtitle {
  animation-delay: 1.4s;
}
