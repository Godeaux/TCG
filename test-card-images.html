<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Image Test</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600&family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
        body {
            padding: 20px;
            background: var(--bg-dark);
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .card {
            width: 200px;
            height: 267px;
            margin: 10px;
            cursor: pointer;
        }
        .inspector-panel {
            width: 350px;
            height: 500px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 14px;
        }
        .inspector-header {
            margin-bottom: 12px;
        }
        .inspector-header h3 {
            font-family: var(--font-display);
            letter-spacing: 0.04em;
            color: var(--gold-light);
            font-size: 20px;
            margin: 0;
        }
    </style>
</head>
<body>
    <div>
        <h2 style="color: white; width: 100%;">Card Image Area Test</h2>
        
        <div class="card type-predator" onclick="showInspector(predatorCard)">
            <div class="card-inner">
                <div class="card-name">Great White Shark</div>
                <div class="card-image-container">
                    <div class="card-image-placeholder">ðŸŽ¨</div>
                </div>
                <div class="card-type-label">Predator</div>
                <div class="card-content-area">
                    <div class="card-stats-row">
                        <span class="card-stat atk">ATK 4</span>
                        <span class="card-stat hp">HP 3</span>
                    </div>
                    <div class="card-keywords">
                        <span>Haste</span>
                        <span>Hidden</span>
                    </div>
                    <div class="card-effect"><strong>Effect:</strong> When this creature attacks, deal 2 damage to the target. This damage cannot be prevented by barrier.</div>
                </div>
            </div>
        </div>

        <div class="card type-prey" onclick="showInspector(preyCard)">
            <div class="card-inner">
                <div class="card-name">Small Fish</div>
                <div class="card-image-container">
                    <div class="card-image-placeholder">ðŸŽ¨</div>
                </div>
                <div class="card-type-label">Prey</div>
                <div class="card-content-area">
                    <div class="card-stats-row">
                        <span class="card-stat atk">ATK 1</span>
                        <span class="card-stat hp">HP 1</span>
                        <span class="card-stat nut">NUT 2</span>
                    </div>
                    <div class="card-keywords">
                        <span>Passive</span>
                    </div>
                    <div class="card-effect"><strong>Effect:</strong> This is a very long effect text that should automatically shrink to fit within the 40% content area allocated for text. It demonstrates the auto-shrinking functionality we implemented.</div>
                </div>
            </div>
        </div>

        <div class="card type-spell" onclick="showInspector(spellCard)">
            <div class="card-inner">
                <div class="card-name">Lightning Bolt</div>
                <div class="card-image-container">
                    <div class="card-image-placeholder">ðŸŽ¨</div>
                </div>
                <div class="card-type-label">Spell</div>
                <div class="card-content-area">
                    <div class="card-keywords"></div>
                    <div class="card-effect"><strong>Effect:</strong> Deal 3 damage to any target. This spell can be cast during your main phase.</div>
                </div>
            </div>
        </div>
    </div>

    <div class="inspector-panel">
        <div class="inspector-header">
            <h3>Card Inspector</h3>
        </div>
        <div id="card-inspector">
            <p class="muted">Tap a card to see its full details.</p>
        </div>
    </div>

    <script>
        // Sample card data
        const predatorCard = {
            name: "Great White Shark",
            type: "Predator",
            atk: 4,
            hp: 3,
            keywords: ["Haste", "Hidden"],
            effect: "When this creature attacks, deal 2 damage to the target. This damage cannot be prevented by barrier."
        };

        const preyCard = {
            name: "Small Fish",
            type: "Prey",
            atk: 1,
            hp: 1,
            nutrition: 2,
            keywords: ["Passive"],
            effect: "This is a very long effect text that should automatically shrink to fit within the 40% content area allocated for text. It demonstrates the auto-shrinking functionality we implemented."
        };

        const spellCard = {
            name: "Lightning Bolt",
            type: "Spell",
            keywords: [],
            effect: "Deal 3 damage to any target. This spell can be cast during your main phase."
        };

        function showInspector(card) {
            const inspector = document.getElementById('card-inspector');
            const stats = [];
            if (card.atk !== undefined) stats.push(`ATK ${card.atk}`);
            if (card.hp !== undefined) stats.push(`HP ${card.hp}`);
            if (card.nutrition !== undefined) stats.push(`NUT ${card.nutrition}`);
            const statsText = stats.join(' â€¢ ');
            
            const keywords = card.keywords?.length ? card.keywords.join(", ") : "";
            const keywordLabel = keywords ? `Keywords: ${keywords}` : "";
            
            const effectBlock = card.effect ? `<div class="effect"><strong>Effect:</strong> ${card.effect}</div>` : "";
            
            inspector.innerHTML = `
                <div class="inspector-card-layout">
                    <div class="inspector-card-image">
                        <div class="inspector-image-container">
                            <div class="inspector-image-placeholder">ðŸŽ¨</div>
                        </div>
                    </div>
                    <div class="inspector-card-content">
                        <h4>${card.name}</h4>
                        <div class="meta">${card.type}${statsText ? ` â€¢ ${statsText}` : ""}</div>
                        ${keywordLabel ? `<div class="meta">${keywordLabel}</div>` : ""}
                        ${effectBlock}
                    </div>
                </div>
            `;
        }

        // Test the auto-shrinking functionality
        document.addEventListener('DOMContentLoaded', () => {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const inner = card.querySelector('.card-inner');
                const adjustTextToFit = () => {
                    const contentArea = inner.querySelector('.card-content-area');
                    const effectElement = inner.querySelector('.card-effect');
                    
                    if (!contentArea || !effectElement) return;
                    
                    // Check if content overflows
                    const isOverflowing = contentArea.scrollHeight > contentArea.clientHeight;
                    
                    if (isOverflowing) {
                        // Start with base font size and reduce until it fits
                        let fontSize = 11;
                        const minFontSize = 8;
                        const step = 0.5;
                        
                        while (fontSize > minFontSize && contentArea.scrollHeight > contentArea.clientHeight) {
                            fontSize -= step;
                            effectElement.style.fontSize = `${fontSize}px`;
                        }
                        
                        // If still overflowing at minimum size, enable more aggressive truncation
                        if (contentArea.scrollHeight > contentArea.clientHeight) {
                            effectElement.style.webkitLineClamp = '2';
                            effectElement.style.lineClamp = '2';
                        }
                    }
                };
                
                // Run adjustment after DOM is rendered
                requestAnimationFrame(adjustTextToFit);
            });
        });
    </script>
</body>
</html>
